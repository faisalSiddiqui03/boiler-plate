<div class="full-height category-listing-page">
  <ion-hide-when size="lg">
    <ion-header>
      <app-header [showCart]="true" [showTime]="true" [headerClass]="'category-header'"></app-header>
    </ion-header>
  </ion-hide-when>
  <div class="content-with-backdrop">
    <div class="product-main-container">
      <div class="product-content">
        <ion-show-when size="lg">
          <ion-header class="top-header-container">
            <app-header [selectedCategoryId]="categoryId" (switchCategory)="switchCategories($event)" [showCart]="true" [showTime]="true"
                        [headerClass]="'category-header'"></app-header>
          </ion-header>
        </ion-show-when>

        <navigation-widget [componentId]="getComponentId()" pfWidgetImpressionTrack
                           [refCode]="'pwa-kuwait'" [level]=1 [executor]="null"
                           [action]="null" (lifecycle)="null">

          <ng-template let-widget="widget">
            <div *ngIf="widget.model">{{assignNav(widget.model)}}</div>
          </ng-template>
        </navigation-widget>
        <div class="container showcase-container full-height">
          <ion-content>
            <delivery-slots-widget *ngIf="fetchDeliverySlots"
                                   [globalSlots]="true"
                                   [deliveryMode]="getFulfilmentMode()?.mode"
                                   [storeId]="getCurrentStore()?.id"
                                   [componentId]="getComponentId()">
            </delivery-slots-widget>
            <ng-container *ngFor="let item of navigations;">
              <div [hidden]="!(item.categoryId === categoryId)">
                <product-showcase-widget [componentId]="getComponentId()" pfWidgetImpressionTrack
                                         [filters]="getShowcaseFilter(item.categoryId)"
                                         [executor]="productShowcaseWidgetExecutor"
                                         [action]="productShowcaseWidgetAction">
                  <ng-template let-widget="widget">
                    <div *ngIf="widget.model == undefined">
                      <div *ngIf="categoryId === dealCategoryId">
                        <ion-grid>
                          <ion-row>
                            <ion-col class="product-card-holder" [sizeXl]="4" [sizeMd]="6" [sizeSm]="6" [sizeXs]="12">
                              <ion-card no-margin no-padding no-border class="product-card deal-card">
                                <ion-card-header>
                                  <app-skeleton [aspectRatio]="2" [width]="'100%'"></app-skeleton>
                                </ion-card-header>
                                <ion-card-content>
                                  <div class="skeleton-warpper">
                                    <ion-skeleton-text class="skeleton-text h2-skeleton"></ion-skeleton-text>
                                  </div>
                                  <div class="skeleton-warpper">
                                    <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                  </div>
                                </ion-card-content>
                              </ion-card>
                            </ion-col>
                            <ion-col class="product-card-holder" [sizeXl]="4" [sizeMd]="6" [sizeSm]="6" [sizeXs]="12">
                              <ion-card no-margin no-padding no-border class="product-card deal-card">
                                <ion-card-header>
                                  <app-skeleton [aspectRatio]="2" [width]="'100%'"></app-skeleton>
                                </ion-card-header>
                                <ion-card-content>
                                  <div class="skeleton-warpper">
                                    <ion-skeleton-text class="skeleton-text h2-skeleton"></ion-skeleton-text>
                                  </div>
                                  <div class="skeleton-warpper">
                                    <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                  </div>
                                </ion-card-content>
                              </ion-card>
                            </ion-col>
                            <ion-col class="product-card-holder" [sizeXl]="4" [sizeMd]="6" [sizeSm]="6" [sizeXs]="12">
                              <ion-card no-margin no-padding no-border class="product-card deal-card">
                                <ion-card-header>
                                  <app-skeleton [aspectRatio]="2" [width]="'100%'"></app-skeleton>
                                </ion-card-header>
                                <ion-card-content>
                                  <div class="skeleton-warpper">
                                    <ion-skeleton-text class="skeleton-text h2-skeleton"></ion-skeleton-text>
                                  </div>
                                  <div class="skeleton-warpper">
                                    <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                  </div>
                                </ion-card-content>
                              </ion-card>
                            </ion-col>
                            <ion-col class="product-card-holder" [sizeXl]="4" [sizeMd]="6" [sizeSm]="6" [sizeXs]="12">
                              <ion-card no-margin no-padding no-border class="product-card deal-card">
                                <ion-card-header>
                                  <app-skeleton [aspectRatio]="2" [width]="'100%'"></app-skeleton>
                                </ion-card-header>
                                <ion-card-content>
                                  <div class="skeleton-warpper">
                                    <ion-skeleton-text class="skeleton-text h2-skeleton"></ion-skeleton-text>
                                  </div>
                                  <div class="skeleton-warpper">
                                    <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                  </div>
                                </ion-card-content>
                              </ion-card>
                            </ion-col>
                            <ion-col class="product-card-holder" [sizeXl]="4" [sizeMd]="6" [sizeSm]="6" [sizeXs]="12">
                              <ion-card no-margin no-padding no-border class="product-card deal-card">
                                <ion-card-header>
                                  <app-skeleton [aspectRatio]="2" [width]="'100%'"></app-skeleton>
                                </ion-card-header>
                                <ion-card-content>
                                  <div class="skeleton-warpper">
                                    <ion-skeleton-text class="skeleton-text h2-skeleton"></ion-skeleton-text>
                                  </div>
                                  <div class="skeleton-warpper">
                                    <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                  </div>
                                </ion-card-content>
                              </ion-card>
                            </ion-col>
                            <ion-col class="product-card-holder" [sizeXl]="4" [sizeMd]="6" [sizeSm]="6" [sizeXs]="12">
                              <ion-card no-margin no-padding no-border class="product-card deal-card">
                                <ion-card-header>
                                  <app-skeleton [aspectRatio]="2" [width]="'100%'"></app-skeleton>
                                </ion-card-header>
                                <ion-card-content>
                                  <div class="skeleton-warpper">
                                    <ion-skeleton-text class="skeleton-text h2-skeleton"></ion-skeleton-text>
                                  </div>
                                  <div class="skeleton-warpper">
                                    <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                  </div>
                                </ion-card-content>
                              </ion-card>
                            </ion-col>
                          </ion-row>
                        </ion-grid>
                      </div>
                      <div *ngIf="categoryId !== dealCategoryId">
                        <ion-grid>
                          <ion-row>
                            <ion-col class="product-card-holder" [sizeSm]="6" [sizeXs]="6" [sizeMd]="4" [sizeLg]="3"
                                     no-padding>
                              <ion-card class="product-card non-deal-card" no-padding>
                                <ion-card-header no-padding>
                                  <app-skeleton [aspectRatio]="2" [width]="'100%'"></app-skeleton>
                                </ion-card-header>

                                <ion-card-content padding>
                                  <ion-card-subtitle color="dark">
                                    <div class="skeleton-warpper">
                                      <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                    </div>
                                  </ion-card-subtitle>
                                  <div class="price-segment" text-end>
                                    <div class="skeleton-warpper">
                                      <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                    </div>
                                  </div>
                                </ion-card-content>
                              </ion-card>
                            </ion-col>
                            <ion-col class="product-card-holder" [sizeSm]="6" [sizeXs]="6" [sizeMd]="4" [sizeLg]="3"
                                     no-padding>
                              <ion-card class="product-card non-deal-card" no-padding>
                                <ion-card-header no-padding>
                                  <app-skeleton [aspectRatio]="2" [width]="'100%'"></app-skeleton>
                                </ion-card-header>

                                <ion-card-content padding>
                                  <ion-card-subtitle color="dark">
                                    <div class="skeleton-warpper">
                                      <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                    </div>
                                  </ion-card-subtitle>
                                  <div class="price-segment" text-end>
                                    <div class="skeleton-warpper">
                                      <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                    </div>
                                  </div>
                                </ion-card-content>
                              </ion-card>
                            </ion-col>
                            <ion-col class="product-card-holder" [sizeSm]="6" [sizeXs]="6" [sizeMd]="4" [sizeLg]="3"
                                     no-padding>
                              <ion-card class="product-card non-deal-card" no-padding>
                                <ion-card-header no-padding>
                                  <app-skeleton [aspectRatio]="2" [width]="'100%'"></app-skeleton>
                                </ion-card-header>

                                <ion-card-content padding>
                                  <ion-card-subtitle color="dark">
                                    <div class="skeleton-warpper">
                                      <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                    </div>
                                  </ion-card-subtitle>
                                  <div class="price-segment" text-end>
                                    <div class="skeleton-warpper">
                                      <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                    </div>
                                  </div>
                                </ion-card-content>
                              </ion-card>
                            </ion-col>
                            <ion-col class="product-card-holder" [sizeSm]="6" [sizeXs]="6" [sizeMd]="4" [sizeLg]="3"
                                     no-padding>
                              <ion-card class="product-card non-deal-card" no-padding>
                                <ion-card-header no-padding>
                                  <app-skeleton [aspectRatio]="2" [width]="'100%'"></app-skeleton>
                                </ion-card-header>

                                <ion-card-content padding>
                                  <ion-card-subtitle color="dark">
                                    <div class="skeleton-warpper">
                                      <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                    </div>
                                  </ion-card-subtitle>
                                  <div class="price-segment" text-end>
                                    <div class="skeleton-warpper">
                                      <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                    </div>
                                  </div>
                                </ion-card-content>
                              </ion-card>
                            </ion-col>
                            <ion-col class="product-card-holder" [sizeSm]="6" [sizeXs]="6" [sizeMd]="4" [sizeLg]="3"
                                     no-padding>
                              <ion-card class="product-card non-deal-card" no-padding>
                                <ion-card-header no-padding>
                                  <app-skeleton [aspectRatio]="2" [width]="'100%'"></app-skeleton>
                                </ion-card-header>

                                <ion-card-content padding>
                                  <ion-card-subtitle color="dark">
                                    <div class="skeleton-warpper">
                                      <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                    </div>
                                  </ion-card-subtitle>
                                  <div class="price-segment" text-end>
                                    <div class="skeleton-warpper">
                                      <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                    </div>
                                  </div>
                                </ion-card-content>
                              </ion-card>
                            </ion-col>
                            <ion-col class="product-card-holder" [sizeSm]="6" [sizeXs]="6" [sizeMd]="4" [sizeLg]="3"
                                     no-padding>
                              <ion-card class="product-card non-deal-card" no-padding>
                                <ion-card-header no-padding>
                                  <app-skeleton [aspectRatio]="2" [width]="'100%'"></app-skeleton>
                                </ion-card-header>

                                <ion-card-content padding>
                                  <ion-card-subtitle color="dark">
                                    <div class="skeleton-warpper">
                                      <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                    </div>
                                  </ion-card-subtitle>
                                  <div class="price-segment" text-end>
                                    <div class="skeleton-warpper">
                                      <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                    </div>
                                  </div>
                                </ion-card-content>
                              </ion-card>
                            </ion-col>
                            <ion-col class="product-card-holder" [sizeSm]="6" [sizeXs]="6" [sizeMd]="4" [sizeLg]="3"
                                     no-padding>
                              <ion-card class="product-card non-deal-card" no-padding>
                                <ion-card-header no-padding>
                                  <app-skeleton [aspectRatio]="2" [width]="'100%'"></app-skeleton>
                                </ion-card-header>

                                <ion-card-content padding>
                                  <ion-card-subtitle color="dark">
                                    <div class="skeleton-warpper">
                                      <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                    </div>
                                  </ion-card-subtitle>
                                  <div class="price-segment" text-end>
                                    <div class="skeleton-warpper">
                                      <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                    </div>
                                  </div>
                                </ion-card-content>
                              </ion-card>
                            </ion-col>
                            <ion-col class="product-card-holder" [sizeSm]="6" [sizeXs]="6" [sizeMd]="4" [sizeLg]="3"
                                     no-padding>
                              <ion-card class="product-card non-deal-card" no-padding>
                                <ion-card-header no-padding>
                                  <app-skeleton [aspectRatio]="2" [width]="'100%'"></app-skeleton>
                                </ion-card-header>

                                <ion-card-content padding>
                                  <ion-card-subtitle color="dark">
                                    <div class="skeleton-warpper">
                                      <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                    </div>
                                  </ion-card-subtitle>
                                  <div class="price-segment" text-end>
                                    <div class="skeleton-warpper">
                                      <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                    </div>
                                  </div>
                                </ion-card-content>
                              </ion-card>
                            </ion-col>
                            <ion-col class="product-card-holder" [sizeSm]="6" [sizeXs]="6" [sizeMd]="4" [sizeLg]="3"
                                     no-padding>
                              <ion-card class="product-card non-deal-card" no-padding>
                                <ion-card-header no-padding>
                                  <app-skeleton [aspectRatio]="2" [width]="'100%'"></app-skeleton>
                                </ion-card-header>

                                <ion-card-content padding>
                                  <ion-card-subtitle color="dark">
                                    <div class="skeleton-warpper">
                                      <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                    </div>
                                  </ion-card-subtitle>
                                  <div class="price-segment" text-end>
                                    <div class="skeleton-warpper">
                                      <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                                    </div>
                                  </div>
                                </ion-card-content>
                              </ion-card>
                            </ion-col>
                          </ion-row>
                        </ion-grid>
                      </div>
                    </div>
                    <div *ngIf="widget.model != undefined && widget.model.length">
                      <ion-hide-when size="lg">
                        <div class="ribbon">
                          <div class="ribbon__side--left">
                            <span></span>
                          </div>
                          <div class="ribbon__side--title" text-uppercase>
                            <span class="cond caps">{{categoryName}}</span>
                          </div>
                          <div class="ribbon__side--right">
                            <span></span>
                          </div>
                          <div class="ribbon__shadow">
                            <span></span>
                          </div>
                        </div>
                      </ion-hide-when>
                      <ion-show-when size="lg">
                        <div class="common-heading-dotted" text-center>
                          <h2 text-uppercase no-margin>{{categoryName}}</h2>
                        </div>
                      </ion-show-when>
                      <div *ngIf="categoryId === dealCategoryId">
                        <ion-grid>
                          <ion-row>
                            <ion-col class="product-card-holder" *ngFor="let prod of widget.model" [sizeXl]="4"
                                     [sizeMd]="6" [sizeSm]="6" [sizeXs]="12">
                              <ion-card no-margin no-padding no-border class="product-card deal-card"
                                        (click)="openDeal(prod?.client)">
                                <ion-card-header>
                                  <img height="170" src="{{getProductImageUrl(prod)}}"
                                       img-preloader="{{getProductImageUrl(prod)}}"
                                       defaultImage="assets/imgs/default/default.png"/>
                                </ion-card-header>
                                <ion-card-content>
                                  <p class="deal-item-name">{{prod.title}}</p>
                                  <p class="deal-item-desc">{{prod.shortDescription}}</p>
                                </ion-card-content>
                              </ion-card>
                            </ion-col>
                          </ion-row>
                        </ion-grid>
                      </div>
                      <div *ngIf="categoryId !== dealCategoryId">
                        <ion-grid>
                          <ion-row>
                            <ion-col class="product-card-holder" *ngFor="let prod of widget.model" [sizeSm]="6"
                                     [sizeXs]="6" [sizeMd]="4" [sizeLg]="3"
                                     no-padding>
                              <ion-card class="product-card non-deal-card" no-padding
                                        (click)="openProductDetails(prod?.client)">
                                <div *ngIf="isLoggedIn()" class="icon"
                                     [ngClass]="{'icon-favourite-active': prod?.isFavorite,'icon-favourite': !prod?.isFavorite}"
                                     (click)="updateFavorites(prod?.isFavorite, prod?.client)"></div>
                                <ion-card-header no-padding>
                                  <img height="100" src="{{getProductImageUrl(prod)}}"
                                       img-preloader="{{getProductImageUrl(prod)}}"
                                       defaultImage="assets/imgs/default/default.png"
                                  />
                                </ion-card-header>

                                <ion-card-content padding>
                                  <ion-card-subtitle class="product-title" color="dark">{{prod.title}}
                                  </ion-card-subtitle>
                                  <div class="price-segment" text-end>
                                    <p>{{'category_listing.price_tag' | translate }}
                                      <span class="label-price">{{prod.webPrice | currency: currencyCode : (currencyCode + ' ') :'1.3-3'}}</span>
                                    </p>
                                  </div>
                                </ion-card-content>
                              </ion-card>
                            </ion-col>
                          </ion-row>
                        </ion-grid>
                      </div>
                    </div>
                  </ng-template>
                </product-showcase-widget>
              </div>
            </ng-container>
          </ion-content>
        </div>
      </div>
      <ion-show-when size="lg">
        <div class="sidebar-cart">
          <div class="fixed-sidebar">
            <app-cart></app-cart>
          </div>
        </div>
      </ion-show-when>
    </div>
  </div>
  <ion-hide-when size="lg">
    <ion-footer no-border>
      <div class="showcase-tabs-one">
        <ul no-margin no-padding>
          <li *ngFor="let item of navigations; let i = index;" text-center class="hello"
              [class.selected]="item.categoryId==categoryId"
              (click)="switchCategories({category: item.name, id: item.categoryId})">{{item.name}}
          </li>
        </ul>
      </div>
      <div class="checkout-btn">
        <ion-button (click)="goToCart()" color="success" text-capitalize expand="block" mode="ios" class="btn-success">
          checkout
        </ion-button>
      </div>
    </ion-footer>
  </ion-hide-when>
</div>
