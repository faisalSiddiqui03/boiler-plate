<div *ngIf="!isShowBundleGroupItems" class="full-height popup-wrap pizza-component">
  <div class="popup-inner full-height">
    <product-display-widget class="full-height" pfWidgetImpressionTrack [action]="productWidgetAction" [productId]="productId"
      [componentId]="getComponentId()">
      <ng-template let-widget="widget">
        <ng-container *ngIf="!loaded">
          <ion-content>
            <ion-card no-padding no-margin>
              <ion-card-header no-padding class="product-img-block">
                <ion-item text-center class="popup-title" no-margin>
                  <ion-icon (click)="goBack()" name="close-circle" slot="start"></ion-icon>
                  <ion-label>
                    <div class="skeleton-warpper">
                      <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                    </div>
                  </ion-label>
                </ion-item>
                <app-skeleton [aspectRatio]="2" [width]="'100%'"></app-skeleton>
              </ion-card-header>
              <ion-card-content>
                <div class="skeleton-warpper">
                  <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                  <ion-skeleton-text class="skeleton-text p-skeleton"></ion-skeleton-text>
                </div>
              </ion-card-content>
            </ion-card>
          </ion-content>
          <ion-footer>
            <ion-button disabled color="success" text-uppercase expand="block" mode="ios" class="btn-success">{{'deal.add_to_basket' | translate}}
            </ion-button>
          </ion-footer>
        </ng-container>

        <ng-container *ngIf="loaded">
          <ion-content no-padding>
            <div class="product-img-block">
              <ion-icon name="close-circle" (click)="goBack()" slot="start"></ion-icon>
              <img alt="{{widget?.model?.title}}" class="product-main-image" height="170" width="340" img-preloader="{{getProductImageUrl(widget?.model)}}"
                defaultImage="assets/imgs/default/default.png" />
            </div>
            <div>
              <div>
                <h4 text-center padding no-margin>{{widget?.model?.title}}</h4>
              </div>
              <div>
                <h6>{{widget?.model?.longDescription}}</h6>
              </div>
            </div>

            <ion-list>
              <ion-item *ngFor="let group of widget?.model?.bundleGroups; let i = index">
                <ion-label>
                  <h4>{{i + 1}}. {{group?.title}}</h4>
                  <p>{{'deal.choose_your' | translate}} {{group?.title}}</p>
                </ion-label>
                <ion-icon color="success" name="add" slot="end" (click)="showBundleGroupItems(group, widget?.model?.client)"></ion-icon>
              </ion-item>
            </ion-list>
          </ion-content>

          <!-- Add to cart -->
          <ion-footer>
            <ion-button color="success" (click)="addToCart(widget?.model?.client)" text-uppercase expand="block" mode="ios" class="btn-success">
              {{'deal.add_to_basket' | translate}} &nbsp;
              <span>{{widget?.model?.client?.price | currency: (currencyCode + ' '): true: '1.3-3'}}</span>
            </ion-button>
          </ion-footer>
        </ng-container>
      </ng-template>
    </product-display-widget>
  </div>
</div>